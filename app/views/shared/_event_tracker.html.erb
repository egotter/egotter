<script>
  (function () {
    var userId = '<%= current_user&.id %>';
    var deviceType = '<%= request.device_type %>';
    var controllerAction = '<%= controller_name %>#<%= action_name %>';

    window.trackPageEvents = function (pageName, eventName) {
      ga('send', {
        hitType: 'event',
        eventCategory: pageName,
        eventAction: eventName + ' / ' + controllerAction,
        eventLabel: JSON.stringify({user_id: userId, deviceType: deviceType})
      });
      ahoy.track(eventName, {deviceType: deviceType, controllerAction: controllerAction});
    }
  })();
</script>
